---
devops_access_users:
  - { username: mjohnson, pubkey: files/ssh-keys/mjohnson }
www_user_ssh_keys:
  - files/ssh-keys/mjohnson



app_domain: dev-m2demo.demo

php_fpm_pm: ondemand
php_fpm_pm_max_children: 10
php_version: 72

redis_version: 32
mysqld_memory_percentage: 50

cachetool_config:
  - path: /home/www-data
    adapter: fastcgi
    fastcgi: /var/run/php-fpm/www-data.sock
    temp_dir: /dev/shm/cachetool
    extensions: [ opcache ]

nginx_vhosts:
  - name: "{{ app_domain }}"
    pool: data
    params:
      server_name: "{{ app_domain }}"
      webroot: /var/www/html/project/sitecode/pub
      #proxy_port: 6081
      proxy_port: 8080
    includes:
      - available.d/magento2-static.conf

nginx_backends:
  - name: www-data
    pool: data
    listen: 8080
    webroot: /var/www/html/project/sitecode/pub
    includes:
      - default.d/nginx-status.conf
      - available.d/realip.conf
      - available.d/magento2.conf

nginx_extras:
  - conf.d/map.conf
  - available.d/realip.conf
  - { src: nginx/magento2-static.conf, dest: available.d/magento2-static.conf }
  - { src: nginx/magento2.conf, dest: available.d/magento2.conf }

nginx_groups: [ www-data ]
nginx_conf_auth_allow: []

# The backend servers are not hanlding SSL termination; optimize this for build speed
nginx_diffie_hellman_bits: 1024
nginx_config_hsts: no
